<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shree Sewing Machine - Sales & Repairs</title>
    <link rel="shortcut icon" href="img/shree_sewing_machine_logo_favicon.png" type="image/x-icon">
    <!-- Firebase SDK -->
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to right, #5c94f3, white);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            width: 100%;
            max-width: 450px;
        }

        .card {
            background: #fff;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        h1 {
            margin-bottom: 20px;
            color: #333;
        }

        .switch-btns {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .switch-btn {
            padding: 10px 20px;
            margin: 0 5px;
            border: none;
            cursor: pointer;
            background: #ddd;
            border-radius: 5px;
            transition: 0.3s;
        }

        .switch-btn.active {
            background: #007bff;
            color: white;
        }

        input {
            display: block;
            width: 90%;
            margin: 10px auto;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        .password-wrapper {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #007bff;
            font-size: 14px;
        }

        .form-btn {
            width: 90%;
            padding: 12px;
            margin: 10px auto;
            border: none;
            background: #28a745;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: 0.3s;
        }

        .form-btn:hover {
            background: #218838;
        }

        .guest-btn {
            background: #17a2b8;
        }

        .guest-btn:hover {
            background: #117a8b;
        }

        .google-btn {
            background: #db4437;
        }

        .google-btn:hover {
            background: #a32d1f;
        }

        .feedback {
            font-size: 12px;
            color: red;
            margin-bottom: 5px;
            display: block;
        }

        .password-strength {
            height: 6px;
            width: 90%;
            background: #e0e0e0;
            margin: 5px auto 15px auto;
            border-radius: 3px;
            overflow: hidden;
        }

        #strengthBar {
            height: 100%;
            width: 0%;
            background: red;
            transition: 0.3s;
        }
    </style>

</head>

<body>

    <div class="container">
        <div class="card">
            <h1>Login Page</h1>
            <div class="switch-btns">
                <button id="showSignIn" class="switch-btn active">Sign In</button>
                <button id="showSignUp" class="switch-btn">Sign Up</button>
            </div>

            <!-- Sign In Form -->
            <div id="signinForm" class="form-container">
                <input type="email" id="signinEmail" placeholder="Email" required>
                <span id="signinEmailFeedback" class="feedback"></span>

                <div class="password-wrapper">
                    <input type="password" id="signinPassword" placeholder="Password" required>
                    <span class="toggle-password" onclick="togglePassword('signinPassword')">Show</span>
                </div>

                <button onclick="signin()" class="form-btn">Sign In</button>
                <button id="googleSignInBtn" class="form-btn google-btn">Sign In with Google</button>
                <button id="guestBtn" class="form-btn guest-btn">Continue as Guest</button>
            </div>

            <!-- Sign Up Form -->
            <div id="signupForm" class="form-container" style="display:none;">
                <input type="text" id="signupUsername" placeholder="Username" required>
                <span id="signupUsernameFeedback" class="feedback"></span>

                <input type="email" id="signupEmail" placeholder="Email" required>
                <span id="signupEmailFeedback" class="feedback"></span>

                <input type="tel" id="signupMobile" placeholder="Mobile Number" required>
                <span id="signupMobileFeedback" class="feedback"></span>

                <div class="password-wrapper">
                    <input type="password" id="signupPassword" placeholder="Password" required>
                    <span class="toggle-password" onclick="togglePassword('signupPassword')">Show</span>
                </div>
                <span id="signupPasswordFeedback" class="feedback"></span>

                <div class="password-strength">
                    <div id="strengthBar"></div>
                </div>

                <button onclick="signup()" class="form-btn">Sign Up</button>
                <button id="googleSignUpBtn" class="form-btn google-btn">Sign Up with Google</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase config (replace with your values)
        const firebaseConfig = {
            apiKey: "AIzaSyDawJavJHcwdqzHHYviEHukvaIkTRjrYv4",
            authDomain: "shreesewingmachine-bf4e6.firebaseapp.com",
            projectId: "shreesewingmachine-bf4e6",
            storageBucket: "shreesewingmachine-bf4e6.firebasestorage.app",
            messagingSenderId: "1055706324681",
            appId: "1:1055706324681:web:03eff083e6c124d1f7b718",
            measurementId: "G-2NCP9KK3V1"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const provider = new firebase.auth.GoogleAuthProvider();

        // Toggle forms
        const showSignInBtn = document.getElementById('showSignIn');
        const showSignUpBtn = document.getElementById('showSignUp');
        const signinForm = document.getElementById('signinForm');
        const signupForm = document.getElementById('signupForm');

        showSignInBtn.onclick = () => { signinForm.style.display = 'block'; signupForm.style.display = 'none'; showSignInBtn.classList.add('active'); showSignUpBtn.classList.remove('active'); };
        showSignUpBtn.onclick = () => { signinForm.style.display = 'none'; signupForm.style.display = 'block'; showSignUpBtn.classList.add('active'); showSignInBtn.classList.remove('active'); };

        // Toggle password
        function togglePassword(id) { const input = document.getElementById(id); input.type = input.type === 'password' ? 'text' : 'password'; }

        // Validation
        function validateEmail(email) { const re = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/; return re.test(email); }
        function checkPasswordStrength(password) {
            let strength = 0; if (password.length >= 6) strength++; if (/[A-Z]/.test(password)) strength++; if (/[0-9]/.test(password)) strength++; if (/[\W]/.test(password)) strength++; return strength;
        }

        // Password strength
        document.getElementById('signupPassword').addEventListener('input', e => {
            const val = e.target.value; const bar = document.getElementById('strengthBar'); const strength = checkPasswordStrength(val);
            switch (strength) { case 0: bar.style.width = '0%'; bar.style.background = 'red'; break; case 1: bar.style.width = '25%'; bar.style.background = 'red'; break; case 2: bar.style.width = '50%'; bar.style.background = 'orange'; break; case 3: bar.style.width = '75%'; bar.style.background = 'yellowgreen'; break; case 4: bar.style.width = '100%'; bar.style.background = 'green'; break; }
        });

        // Sign Up
        function signup() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const mobile = document.getElementById('signupMobile').value.trim();
            const password = document.getElementById('signupPassword').value.trim();

            const uF = document.getElementById('signupUsernameFeedback');
            const eF = document.getElementById('signupEmailFeedback');
            const mF = document.getElementById('signupMobileFeedback');
            const pF = document.getElementById('signupPasswordFeedback');
            uF.innerText = ''; eF.innerText = ''; mF.innerText = ''; pF.innerText = '';

            if (username.length < 3) { uF.innerText = 'Username min 3 chars'; return; }
            if (!validateEmail(email)) { eF.innerText = 'Invalid email'; return; }
            if (!/^\d{10}$/.test(mobile)) { mF.innerText = 'Enter valid 10-digit mobile'; return; }
            if (password.length < 6) { pF.innerText = 'Password min 6 chars'; return; }

            auth.createUserWithEmailAndPassword(email, password).then(userCredential => {
                const user = userCredential.user;
                db.collection('users').doc(user.uid).set({ username, email, mobile }).then(() => {
                    window.location.href = 'home.html';
                });
            }).catch(err => alert(err.message));
        }

        // Sign In
        function signin() {
            const email = document.getElementById('signinEmail').value.trim();
            const password = document.getElementById('signinPassword').value.trim();
            const eF = document.getElementById('signinEmailFeedback'); eF.innerText = '';
            if (!validateEmail(email)) { eF.innerText = 'Invalid email'; return; }
            auth.signInWithEmailAndPassword(email, password).then(() => window.location.href = 'home.html').catch(err => alert(err.message));
        }

        // Google Sign In
        document.getElementById('googleSignInBtn').addEventListener('click', () => { auth.signInWithPopup(provider).then(() => window.location.href = 'home.html').catch(err => alert(err.message)); });
        document.getElementById('googleSignUpBtn').addEventListener('click', () => { auth.signInWithPopup(provider).then(() => window.location.href = 'home.html').catch(err => alert(err.message)); });

        // Guest login
        document.getElementById('guestBtn').addEventListener('click', () => { auth.signInAnonymously().then(() => window.location.href = 'home.html').catch(err => alert(err.message)); });
    </script>

</body>

</html>